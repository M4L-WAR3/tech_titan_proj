<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LifeOS Dashboard</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@400;600&display=swap');

  body, html {
    width: 100%;
    margin: 0; padding: 0; height: 100%;
    font-family: 'Oswald', sans-serif;
    background: url('wallpaper1.jpg') no-repeat center center fixed;
    background-size: cover;
    color: #f5edd8;
    overflow: hidden;
    display: flex;
    height: 100vh;
  }

  /* Left Panel: ToDo */
  #leftPanel {
    width: 350px;
    background: rgba(48, 74, 54, 0.9);
    display: flex;
    flex-direction: column;
    padding: 1rem;
    box-shadow: 0 0 15px rgb(48,74,54);
    overflow-y: auto;
  }

  #leftPanel h2 {
    margin-top: 0;
  }

  #habitcontainer {
    margin-top: 1rem;
    flex-grow: 1;
    overflow-y: auto;
  }

  #habitcontainer .hab {
    display: flex;
    align-items: center;
    margin: 0.25rem 0;
    background: #486938;
    padding: 0.3rem 0.5rem;
    border-radius: 8px;
    cursor: default;
  }
  #habitcontainer .check {
    width: 20px; height: 20px;
    border: 2px solid #f5edd8;
    margin-right: 10px;
    cursor: pointer;
    user-select: none;
  }
  #habitcontainer .check.checked {
    background-color: black;
  }
  #habitcontainer .cont {
    flex-grow: 1;
    user-select: none;
  }

  /* Center Panel: Tabs + Iframes */
  #centerPanel {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    background: rgba(0,0,0,0.4);
    margin: 1rem;
    border-radius: 12px;
    box-shadow: 0 0 15px rgba(0,0,0,0.5);
  }

  #scheduleInput {
    width: 95%;
  }

  #motiv {
    font-size: 1.75rem;
    font-weight: 300;
    color: #d4e09b;
    padding: 1rem;
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }

  .tabs-btn-group {
    display: flex;
    border-bottom: 2px solid #6a945c;
  }
  .tabs-btn-group button {
    font-family: 'Oswald', sans-serif;
    font-weight: 400;
    color: #f5edd8;
    background-color: #304a36;
    border: none;
    border-radius: 0.3rem 0.3rem 0 0;
    margin-right: 0.2rem;
    cursor: pointer;
    padding: 0.5rem 1rem;
    transition: background-color 0.3s ease;
  }
  .tabs-btn-group button.active,
  .tabs-btn-group button:hover {
    background-color: #6a945c;
    color: #1f2e1e;
  }

  iframe.yes {
    flex-grow: 1;
    width: 100%;
    border: none;
    border-radius: 0 0 12px 12px;
    display: none;
  }
  iframe.yes.active {
    display: block;
  }

  /* Right Panel: Pomodoro + Schedule */
  #rightPanel {
    width: 350px;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  /* Pomodoro */
  #pomodoroPanel {
    background: rgba(48, 74, 54, 0.9);
    border-radius: 12px;
    box-shadow: 0 0 15px rgb(48,74,54);
    padding: 1rem;
    text-align: center;
    user-select: none;
  }
  #pomodoroPanel h2 {
    margin: 0 0 1rem 0;
  }
  #pomodoroPanel p {
    font-size: 3rem;
    margin: 0 0 1rem 0;
    font-weight: 600;
  }
  #pomodoroPanel button {
    background: #6a945c;
    border: none;
    padding: 0.5rem 1rem;
    margin: 0 0.25rem;
    border-radius: 6px;
    color: #1f2e1e;
    cursor: pointer;
    font-weight: 600;
    font-family: 'Oswald', sans-serif;
    transition: background-color 0.2s ease;
  }
  #pomodoroPanel button:hover {
    background-color: #4a6c3d;
  }

  /* Schedule Panel */
  #schedulePanel {
    background: rgba(48, 74, 54, 0.9);
    border-radius: 12px;
    box-shadow: 0 0 15px rgb(48,74,54);
    padding: 1rem;
    flex-grow: 1;
    overflow-y: auto;
  }
  #schedulePanel h2 {
    margin-top: 0;
    margin-bottom: 1rem;
  }
  #schedulePanel textarea {
    width: 95%;
    min-height: 80px;
    background: #486938;
    border: none;
    border-radius: 8px;
    color: #f5edd8;
    font-family: 'Oswald', sans-serif;
    font-size: 1rem;
    padding: 0.5rem;
    resize: vertical;
  }
  #schedulePanel button {
    margin-top: 0.5rem;
    background: #6a945c;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    color: #1f2e1e;
    cursor: pointer;
    font-weight: 600;
  }

  /* Clock top of left panel */
  #clock {
    font-size: 4rem;
    font-weight: 600;
    user-select: none;
  }

  /* Add habit input & buttons */
  #habitInputGroup {
    margin-top: 0.75rem;
    display: flex;
    gap: 0.5rem;
  }
  #habitInputGroup input {
    flex-grow: 1;
    border-radius: 8px;
    border: none;
    padding: 0.5rem 1rem;
    font-family: 'Oswald', sans-serif;
    font-size: 1rem;
  }
  #habitInputGroup button {
    background: #6a945c;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    color: #1f2e1e;
    cursor: pointer;
    font-weight: 600;
  }
  #habitInputGroup button:hover {
    background-color: #4a6c3d;
  }
</style>
</head>
<body>

<!-- LEFT PANEL: Todo + Clock -->
<div id="leftPanel">
  <div id="clock">
    <span id="hrs">00</span>:<span id="min">00</span>
  </div>
  <div id="habitInputGroup">
    <input id="inp" type="text" placeholder="Add a new habit" />
    <button id="btn">Add</button>
    <button id="save">Save</button>
  </div>
  <div id="habitcontainer"></div>
</div>

<!-- CENTER PANEL: Motivational + Tabs + Iframes -->
<div id="centerPanel">
  <p id="motiv"></p>
  <div class="tabs-btn-group">
    <button class="tablinks active" onclick="frame(event, 0)">TextBook Generator</button>
    <button class="tablinks" onclick="frame(event, 1)">Quiz Generator</button>
    <button class="tablinks" onclick="frame(event, 2)">Doubts Solver</button>
    <button class="tablinks" onclick="frame(event, 3)">View Files</button>
  </div>
  <iframe class="yes active" src="http://127.0.0.1:5000/" allowfullscreen></iframe>
  <iframe class="yes" src="http://127.0.0.1:5000/?quiz" allowfullscreen></iframe>
  <iframe class="yes" src="http://127.0.0.1:5000/?doubt" allowfullscreen></iframe>
  <iframe class="yes" src="http://127.0.0.1:5000/files" allowfullscreen></iframe>
</div>

<!-- RIGHT PANEL: Pomodoro + Schedule -->
<div id="rightPanel">
  <div id="pomodoroPanel">
    <h2>Pomodoro Timer</h2>
    <p><span id="pomoMin">25</span>:<span id="pomoSec">00</span></p>
    <button onclick="inc()">+10 min</button>
    <button onclick="dec()">-10 min</button>
    <button onclick="pomoStart()">Start/Stop</button>
  </div>

  <div id="schedulePanel">
    <h2>Schedule</h2>
    <textarea id="scheduleInput" placeholder="Add your schedule notes here..."></textarea>
    <button id="saveSchedule">Save Schedule</button>
  </div>
</div>

<script>
  // ------------------- CLOCK & MOTIVATIONAL --------------------
  let hrs = document.getElementById('hrs');
  let min = document.getElementById('min');
  let motiv = document.getElementById('motiv');

  const quotes = [
    "Every step forward counts, no matter how small--keep moving toward your dreams.",
    "Challenges are just opportunities in disguise; embrace them and grow.",
    "Your potential is limitless when you believe in yourself and take action.",
    "Success is not the absence of obstacles, but the courage to push through them.",
    "Your future is built by the choices you make today--choose boldly.",
    "You do not need to be perfect to start, but you need to start to become great.",
    "The only limits are the ones you set for yourself--break free and soar.",
    "Turn your setbacks into comebacks with determination and grit."
  ];

  function updateClock() {
    const d = new Date();
    let hours = d.getHours();
    let minutes = d.getMinutes();
    hrs.innerHTML = hours < 10 ? '0' + hours : hours;
    min.innerHTML = minutes < 10 ? '0' + minutes : minutes;
  }

  function setMotivational() {
    motiv.innerText = quotes[Math.floor(Math.random() * quotes.length)];
  }

  // ------------------- TODO LIST --------------------
  let habitcont = document.getElementById('habitcontainer');
  let inp = document.getElementById('inp');
  let btn = document.getElementById('btn');
  let save = document.getElementById('save');
  let localArr = [];

  class ToDo {
    constructor(name, checked) {
      this.name = name;
      this.checked = checked === true || checked === 'true';
    }
    create() {
      addToDo(this.name, this.checked);
    }
  }

  function addToDo(name, checked) {
    let hab = document.createElement('div');
    hab.classList.add('hab');
    habitcont.appendChild(hab);

    let check = document.createElement('div');
    check.classList.add('check');
    if (checked) check.classList.add('checked');
    hab.appendChild(check);

    check.addEventListener('click', () => {
      check.classList.toggle('checked');
      updateLocalArr();
    });

    hab.addEventListener('dblclick', () => {
      habitcont.removeChild(hab);
      updateLocalArr();
    });

    let cont = document.createElement('p');
    cont.classList.add('cont');
    cont.innerText = name;
    hab.appendChild(cont);

    updateLocalArr();
  }

  function updateLocalArr() {
    localArr = [];
    document.querySelectorAll('#habitcontainer .hab').forEach(hab => {
      let name = hab.querySelector('.cont').innerText;
      let checked = hab.querySelector('.check').classList.contains('checked');
      localArr.push([name, checked]);
    });
  }

  function saveToDo() {
    localStorage.setItem('habits', JSON.stringify(localArr));
    alert('Habits saved!');
  }

  function loadToDos() {
    let saved = localStorage.getItem('habits');
    if (!saved) return;
    let arr = JSON.parse(saved);
    habitcont.innerHTML = '';
    arr.forEach(([name, checked]) => {
      addToDo(name, checked);
    });
  }

  btn.addEventListener('click', () => {
    if (inp.value.trim() === '') return alert('Please enter a habit');
    addToDo(inp.value.trim(), false);
    inp.value = '';
  });
  save.addEventListener('click', saveToDo);

  // ------------------- POMODORO TIMER --------------------
  let pomoMinEl = document.getElementById('pomoMin');
  let pomoSecEl = document.getElementById('pomoSec');
  let pomoCounter = 0;
  let pomoInterval;

  function inc() {
    let mins = parseInt(pomoMinEl.innerText);
    pomoMinEl.innerText = mins + 10;
  }

  function dec() {
    let mins = parseInt(pomoMinEl.innerText);
    if (mins <= 10) {
      alert("Time cannot be negative!!");
      return;
    }
    pomoMinEl.innerText = mins - 10;
  }

  function pomo() {
    let mins = parseInt(pomoMinEl.innerText);
    let secs = parseInt(pomoSecEl.innerText);

    if (secs === 0) {
      if (mins === 0) {
        alert('Pomodoro timer over');
        clearInterval(pomoInterval);
        pomoCounter = 0;
        pomoMinEl.innerText = '25';
        pomoSecEl.innerText = '00';
        return;
      }
      mins--;
      secs = 59;
    } else {
      secs--;
    }

    pomoMinEl.innerText = mins < 10 ? '0' + mins : mins;
    pomoSecEl.innerText = secs < 10 ? '0' + secs : secs;
  }

  function pomoStart() {
    if (pomoCounter === 0) {
      pomoInterval = setInterval(pomo, 1000);
      pomoCounter = 1;
    } else {
      clearInterval(pomoInterval);
      pomoCounter = 0;
    }
  }

  // ------------------- TABS --------------------
  function frame(evt, index) {
    let iframes = document.querySelectorAll('iframe.yes');
    let buttons = document.querySelectorAll('.tabs-btn-group button');

    iframes.forEach((frame, i) => {
      frame.classList.toggle('active', i === index);
    });
    buttons.forEach((btn, i) => {
      btn.classList.toggle('active', i === index);
    });
    if(index == 3) {
      document.getElementsByTagName('iframe')[3].src = 'http://127.0.0.1:5000/files';
    }
  }
  window.frame = frame;

  // ------------------- SCHEDULE --------------------
  let scheduleInput = document.getElementById('scheduleInput');
  let saveScheduleBtn = document.getElementById('saveSchedule');

  function saveSchedule() {
    localStorage.setItem('scheduleNotes', scheduleInput.value);
    alert('Schedule saved!');
  }

  function loadSchedule() {
    let saved = localStorage.getItem('scheduleNotes');
    if (saved) scheduleInput.value = saved;
  }

  saveScheduleBtn.addEventListener('click', saveSchedule);

  // ------------------- INITIALIZE --------------------
  window.onload = () => {
    updateClock();
    setMotivational();
    loadToDos();
    loadSchedule();
    setInterval(updateClock, 1000);
  };
</script>

</body>
</html>
